---
- tags: registry
  hosts: all
  become: yes
  become_user: root
  tasks:
    - name: create workspace
      file:
        dest: /home/vagrant/potatobox/roles/registry
        state: directory
        owner: vagrant
        group: vagrant

    - name: copy docker-compose.yaml
      copy:
        src: docker-compose.yaml
        dest: /home/vagrant/potatobox/roles/registry/docker-compose.yaml
        owner: vagrant
        group: vagrant
      notify:
        - Restart

  handlers:
    - name: Restart
      shell: docker-compose --no-ansi stop; docker-compose --no-ansi up -d
      args:
        chdir: /home/vagrant/potatobox/roles/registry
